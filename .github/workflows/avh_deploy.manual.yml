name: AVH_Deploy_Manual

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'The environment to deploy.'
        required: true
        default: Azure
      environmentCloud:
        description: 'The Azure Cloud environment to deploy.'
        required: true
        default: azurecloud      
      environmentShortName:
        description: 'The environment Shorten name. i.e. dev, prod, sbx'
        required: true
        type: choice
        options:
        - dev
        - sbx
        - staging
        - preprod
        - prod
      resourceGroupName:
        description: 'The name of the Resource Group to deploy the AVH.'
        required: true

jobs:
  avh_deploy:
    name: 'Deploy Azure Virtualization Host'
    uses: Nchaos/NaaS/.github/workflows/avh_deploy.yml@master
    with:
      environment: ${{ github.event.inputs.environment }}
      environmentCloud: ${{ github.event.inputs.environmentCloud }}
      environmentShortName: ${{ github.event.inputs.environmentShortName }}
      resourceGroupName: ${{ github.event.inputs.resourceGroupName }}
    secrets:
      AZURE_CREDS: ${{ secrets.AZURE_CREDENTIALS }}
      ADMIN_PUB_KEY: ${{ secrets.ADMIN_PUB_KEY }}